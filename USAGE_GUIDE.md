# 使用指南

## 快速开始

### 1. 一键启动（推荐）

```bash
# 启动智能收集器
python smart_collector.py
```

这将打开交互式界面，您可以：
- 查看收集状态
- 分析英雄位置
- 开始数据收集
- 继续上次收集

### 2. 分步操作

#### 步骤1: 分析英雄位置
```bash
python hero_position_analyzer.py
```

#### 步骤2: 收集数据
```bash
python data_collector.py
```

#### 步骤3: 训练模型
```bash
python trainer.py
```

#### 步骤4: 进行预测
```bash
python run_example.py
```

## 详细说明

### 智能数据收集器

智能收集器 (`smart_collector.py`) 是推荐的使用方式，它提供了：

1. **自动发现玩家**: 无需手动输入玩家ID
2. **断点续传**: 支持中断后继续收集
3. **网络错误处理**: 自动重试和恢复
4. **API限制管理**: 智能控制请求频率
5. **实时进度保存**: 防止数据丢失

### 英雄位置分析器

英雄位置分析器 (`hero_position_analyzer.py`) 自动分析英雄位置：

1. **数据来源**: 从OpenDota API获取比赛数据
2. **分析方法**: 基于GPM、XPM、KDA等统计指标
3. **位置分配**: 自动分配1-5号位
4. **置信度评估**: 提供位置分配的可靠性评估

### 数据收集策略

考虑到API限制，系统采用以下策略：

1. **分批收集**: 每次收集少量玩家数据
2. **缓存机制**: 本地缓存已获取的数据
3. **请求限制**: 控制请求频率，避免超出限制
4. **定期更新**: 根据需要定期更新数据

### 网络错误处理

系统具备完善的错误处理机制：

1. **自动重试**: 网络错误时自动重试
2. **指数退避**: 重试间隔逐渐增加
3. **状态保存**: 错误时保存已收集的数据
4. **优雅退出**: 支持Ctrl+C安全退出

## 常见问题

### Q: 如何查看收集进度？
A: 运行 `python smart_collector.py` 选择"查看收集状态"

### Q: 如何继续上次的收集？
A: 运行 `python smart_collector.py` 选择"继续上次收集"

### Q: 如何分析英雄位置？
A: 运行 `python hero_position_analyzer.py` 或使用智能收集器

### Q: API限制如何处理？
A: 系统会自动管理API限制，达到限制时会停止收集

### Q: 如何自定义收集的玩家数量？
A: 在智能收集器中选择"开始数据收集"并输入目标数量

## 配置说明

### 修改API限制
编辑 `config.py` 中的 `APIConfig` 类：
```python
rate_limit_per_minute = 60  # 每分钟请求数
rate_limit_per_month = 50000  # 每月请求数
request_delay = 1.0  # 请求间隔（秒）
```

### 修改收集参数
编辑 `config.py` 中的 `DataConfig` 类：
```python
max_matches_per_player = 100  # 每个玩家最大比赛数
min_matches_per_player = 10   # 每个玩家最小比赛数
recent_days = 365  # 最近多少天的数据
```

### 修改模型参数
编辑 `config.py` 中的 `ModelConfig` 类：
```python
batch_size = 32  # 批处理大小
learning_rate = 0.001  # 学习率
epochs = 100  # 训练轮数
```

## 故障排除

### 内存不足
- 减少 `batch_size` 到 16 或 8
- 减少 `max_matches_per_player` 到 50

### 网络问题
- 检查网络连接
- 增加 `request_delay` 到 2.0 秒
- 使用VPN（如果API访问受限）

### API限制
- 等待下个月重置
- 考虑使用付费API
- 减少收集的玩家数量

### 模型训练失败
- 检查数据质量
- 确保有足够的训练数据
- 调整模型参数

## 最佳实践

1. **首次使用**: 先运行英雄位置分析，再开始数据收集
2. **数据收集**: 建议每天收集少量数据，避免超出API限制
3. **模型训练**: 收集足够数据后再开始训练
4. **定期更新**: 定期更新英雄位置和模型
5. **备份数据**: 定期备份收集的数据和训练好的模型

## 技术支持

如果遇到问题，请检查：
1. Python版本 >= 3.8
2. 依赖包是否正确安装
3. 网络连接是否正常
4. 磁盘空间是否充足
5. 日志文件中的错误信息
